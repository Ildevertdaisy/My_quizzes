#1

---

### **Comprendre les paramètres dans une API**

Une **API** (une porte d’entrée pour que les applis puissent discuter 📡), c’est comme un robot assistant qui fait ce qu’on lui demande. 

Mais pour bien faire, il a besoin qu’on lui donne des infos précises !


Par exemple, si tu dis juste :
  🟢 *« Joue une chanson ! »* → L’appli ne sait pas laquelle.

  Mais si tu dis :
  🟢 *« Joue **Shape of You** ! »* → Là, elle comprend mieux ce que tu veux.

Les infos qu’on donne s’appellent des **paramètres** !

Dans une API, il y a deux types importants :

---

## **1️⃣ Les paramètres de chemin (Path Parameters)**

Ce sont comme des panneaux sur la route 🛣️.

Ils sont dans l’adresse (l’URL) de l’API et disent ce qu’on veut exactement.

🔹 Dans une appli de **films** 🎬, si tu veux voir le film *Avatar*, l’API peut faire :
👉 `www.cineapp.com/films/avatar`

Ici, *avatar* est un **paramètre de chemin** (dans l’adresse) qui dit exactement quel film tu veux.

🎯 **À retenir** :

* Les **paramètres de chemin** sont dans l’adresse de l’API.
* Ils servent à dire exactement ce qu’on cherche (comme un film ou un joueur 🎮).

---
## **2️⃣ Les paramètres de requête (Query Parameters)**

Ce sont comme des petits mots qu’on donne au vendeur 📩 pour lui dire encore mieux ce qu’on veut.

Ils s’ajoutent à l’adresse de l’API avec un `?`, suivi des infos.

🔹 Exemple avec une appli de **météo** 🌤️ :
👉 `www.meteo.com/previsions?ville=Paris&jour=lundi`

Ici :

* `ville=Paris` dit qu’on veut la météo à Paris.
* `jour=lundi` précise le jour.

Ce sont des **paramètres de requête** (des petits mots pour donner plus de détails 📩).


🎯 **À retenir** :

* Les **paramètres de requête** viennent après un `?` dans l’adresse.
* Ils servent à mieux préciser ce qu’on cherche (comme une couleur ou une date).
* On peut en mettre plusieurs, séparés par `&`.

---

## **Pourquoi c’est important ?**

Sans paramètres, une API est trop rigide ❌.

C’est comme un robot qui comprend juste *« joue une chanson »*, mais pas laquelle.

Avec les **paramètres de chemin**, on va chercher quelque chose de précis (comme un film ou un joueur).

Avec les **paramètres de requête**, on peut filtrer ce qu’on veut (comme trier des jeux par genre).

Les API utilisent ces outils partout :
✅ **Netflix** pour les films 🎬.
✅ **Google Maps** pour les adresses 🗺️.
✅ **YouTube** pour filtrer les vidéos 🔍.

Bref, tout ce qui aide à parler avec une appli !

---


#2


---

### **Utiliser les paramètres dans FastAPI**

Une **API** (un messager pour que les applis se parlent 📡), a besoin d’infos précises.
Comme un assistant vocal :

* *"Je veux une chanson"* → il ne sait pas quoi jouer.
* *"Joue **Shape of You**"* → il comprend exactement.

Pour que l’API soit maligne et rapide, on lui donne des **paramètres**.

Comme ça, elle comprend bien ce que l’utilisateur veut et répond juste.

Il existe 2 types de paramètres très utiles avec FastAPI :
  
---

## **1️⃣ Les paramètres de chemin (Path Parameters) 🚦**

Ce sont comme des panneaux sur une route 🚗.

Ils sont dans l’adresse (URL) de l’API et disent exactement ce qu’on veut voir.
### **Exemples concrets 📱 :**

* **Appli de sport ⚽** :
  👉 `www.sportstats.com/joueurs/messi`

  Ici, *messi* est un **paramètre de chemin** (dans l’adresse) qui dit qu’on veut voir ses stats.

🎯 **Pourquoi c’est utile ?**

* Ça permet d’aller direct vers quelque chose de précis (comme un joueur ou un produit).
* Et ça aide l’appli à bien ranger les infos.
 

---
## **2️⃣ Les paramètres de requête (Query Parameters) 🔍**

Ce sont comme des petits papiers 📝 qu’on donne pour dire ce qu’on veut en détail.

Ils viennent après un `?` dans l’adresse (URL) et servent à mieux préciser une recherche.

### **Exemple 📱 :**

* **Appli météo ☀️** :
  👉 `www.meteo.com/previsions?ville=Paris&jour=lundi`
  Ici, `ville=Paris` et `jour=lundi` sont des **paramètres de requête** (après le `?`) pour dire ce qu’on cherche exactement.

🎯 **Pourquoi c’est utile ?**

* Ça aide à faire une recherche plus précise.
* On peut mettre plusieurs paramètres pour voir juste ce qu’on veut.

---

## **3️⃣ Tester son API 🔧**

Une API, c’est comme un robot assistant 🤖.

Pour qu’il marche bien, il faut **tester** ses réponses et voir s’il comprend bien ce qu’on lui dit.

### **Pourquoi tester son API ?**

* Pour voir si elle comprend bien les **paramètres**.
* Pour éviter les erreurs (ex : si un film n’existe pas).
* Pour que l’appli reste rapide et fluide.

---

## **Conclusion 🚀**

Les **paramètres** rendent une API super forte et facile à utiliser 💪.

* Les **paramètres de chemin** vont direct à ce qu’on cherche (comme un film ou un joueur).
* Les **paramètres de requête** aident à bien filtrer (par date, genre, couleur…).
* Tester l’API évite les bugs et rend tout plus simple pour l’utilisateur.

Sans les **paramètres**, les applis seraient perdues et répondraient mal.

On les utilise tout le temps : pour chercher un resto, écouter une chanson ou commander un produit 🌍💡.

---



#3

### **Prêt pour les paramètres de chemin dans FastAPI 🚀**

Un **endpoint** (une porte pour recevoir ou envoyer des infos 📡), c’est la base.

Si tu sais déjà en faire un simple, tu peux continuer !
 
---
## **C’est quoi un paramètre de chemin ? 🤔**

Un **paramètre de chemin** (ou *path parameter*) est une partie de l’adresse (URL) qui change selon ce que l’utilisateur demande.

Par exemple, dans une **appli de bibliothèque 📚**, si on veut voir un livre précis, l’adresse peut être :
👉 `/books/{book_id}`

Ici, `{book_id}` est un **paramètre de chemin** (il change selon le livre demandé).

Dans l’adresse :

* **/books/** veut dire qu’on cherche des livres.
* **{book\_id}** est un **paramètre de chemin** (l’identifiant du livre).

Par exemple, pour le livre **123** :
👉 `/books/123`

📌 **Exemples d’applis avec des paramètres de chemin :**

🔹 **Streaming 🎬** :
👉 `/films/567` → montre le film numéro 567.

🔹 **Jeux vidéo 🎮** :
👉 `/joueurs/superGamerX` → affiche les stats de ce joueur.

---

## **FastAPI et les paramètres de chemin 🏎️**

**FastAPI** (outil pour créer des API très vite ⚡) permet de **capturer** facilement les **paramètres de chemin** et de les utiliser dans une **fonction** (des instructions pour bien répondre).

FastAPI récupère le **paramètre de chemin** et l’utilise pour répondre.

Si on demande **/books/123**, il comprend que "123" est l’ID du livre et va chercher les bonnes infos.

💡 **Pourquoi c’est super utile ?**

* L’API devient **plus flexible** : elle peut montrer n’importe quel livre ou joueur.
* On gagne du temps : pas besoin de chercher dans une liste, on demande direct.
* C’est utilisé **partout** : e-commerce, jeux, applis de livraison, réseaux sociaux…

---

### **Résumé 📌**

* Un **paramètre de chemin** est une partie de l’adresse qui change selon ce qu’on cherche (film, joueur, resto…).
* Il s’écrit souvent comme ça : `{nom_du_paramètre}` (ex : `/books/{book_id}`).
* **FastAPI** les récupère facilement pour répondre juste.
* On les retrouve **dans plein d’applis** : Netflix, YouTube, Amazon…

🎯 **Avec les paramètres de chemin, une API devient plus maligne et rapide !** 🚀



#4

---

### **Nouveau : voir les infos d’un auteur 📚**

Dans notre appli de bibliothèque, on veut maintenant pouvoir récupérer les infos sur un **auteur** (la personne qui écrit des livres ✍️).

On va ajouter un **nouvel endpoint** (une nouvelle porte 📡) pour demander les infos d’un **auteur** en donnant son **identifiant** (un numéro unique pour le reconnaître).

Voici le code utilisé pour créer cet endpoint avec **FastAPI** :  

```python
@app.get("/authors/{author_id}")
async def read_author(author_id: int):
    return {
        "author_id": author_id,
        "name": "Ernest Hemingway"
    }
```

Regardons ensemble **chaque partie** de ce code et ce qu’elle signifie ! 🚀  

---

## **1️⃣ @app.get("/authors/{author\_id}")**

🔹 `@app.get(...)` :

  * Ça veut dire **"je crée une nouvelle porte (endpoint) pour récupérer des infos"**.
  * Un **endpoint** est comme une porte d’immeuble 🏢.
  * La méthode **GET** veut dire **"je veux des infos"** (comme quand on demande la météo ☀️).
🔹 `"/authors/{author_id}"` :

🔹 `"/authors/{author_id}"` :

* `"/authors/"` veut dire qu’on cherche des infos sur un **auteur**.
* `{author_id}` est un **paramètre de chemin** (il change selon l’auteur).
* Exemple :
  👉 `.../authors/1` → auteur 1
  👉 `.../authors/2` → auteur 2

📌 **Exemples dans d’autres applis :**

* **Cinéma 🎬** : `/films/{film_id}` → voir un film précis
* **Sport ⚽** : `/joueurs/{player_id}` → voir les stats d’un joueur

---

## **2️⃣ async def read\_author(author\_id: int):**

🔹 `def` = **je crée une fonction** (un petit programme).
🔹 `async` = **la fonction répond vite et à plusieurs personnes à la fois** 📞.
🔹 `read_author` = **le nom** de la fonction.

🔹 `(author_id: int)` :
  * `author_id` est un **paramètre de chemin** pris dans l’adresse.
  * `int` veut dire que c’est un **nombre entier** (pas de lettres ou de symboles).
  

🎯 **Comme une appli à qui tu dis** :
*"Donne-moi l’auteur numéro 3 !"*
Elle comprend, cherche l’auteur, et te dit son nom.

---

## **3️⃣ Le retour de la fonction :**  

```python
return {
    "author_id": author_id,
    "name": "Ernest Hemingway"
}
```
🔹 `return {...}` :
  * Ça veut dire **"voici la réponse de l’API"**.
  * La réponse est un **dictionnaire** (une boîte 📦 avec des infos dedans).

🔹 `"author_id": author_id` :
  * Ça montre **l’identifiant** de l’auteur.
  * Si on écrit `/authors/5`, l’API répondra avec `"author_id": 5`.

🔹 `"name": "Ernest Hemingway"` :
  * Le **nom affiché est toujours le même**, peu importe l’`author_id`.
  * L’API dira toujours `"Ernest Hemingway"`.


📌 **Ce qui change** :

Si on tape `/authors/10`, on voit :

```json
{  
  "author_id": 10,  
  "name": "Ernest Hemingway"  
}  
```

Le **numéro change**, mais le **nom reste toujours le même**.


---

### **Pourquoi c’est important ? 🤔**

💡 Avec les **paramètres de chemin**, l’API devient super pratique !

* Elle montre les détails d’un **auteur précis** sans faire plein de liens différents.
* Cette idée marche aussi pour le **cinéma**, le **sport**, les **jeux**, les **boutiques**…

---

### **Résumé final 📌**

✅ Un **endpoint GET** est une porte pour demander des infos.
✅ **FastAPI capte un paramètre** (comme un numéro d’auteur) dans l’adresse.
✅ Une **fonction** traite la demande et répond.
✅ La réponse est un **dictionnaire** (une boîte avec des infos).

Avec cette technique, on peut faire plein d’applis :

* 🎵 Voir un album avec son ID.
* 🏪 Voir un article de boutique avec son ID.

🚀 **Les API rendent les applis plus vivantes et faciles à utiliser !**

---

#5




#6

### **Les paramètres de requête : pour filtrer ce qu’on cherche 🎯**

Dans une **API** (un pont pour que les applis se parlent 📡), on ne veut pas toujours tout voir.

Parfois, on veut **filtrer** ou **personnaliser**, comme quand on fait une recherche sur un site.

Les **paramètres de requête** (query parameters) servent à **ajouter des précisions** pour que l’API donne une réponse plus exacte.

---

## **📌 Comment ça marche ?**

Les **paramètres de requête** viennent **après un `?`** dans l’adresse.

Ils sont faits de **clés et valeurs** reliées par un `=`.

📌 **Exemple avec une bibliothèque 📚**

* Pour voir tous les livres : 👉 `/books`
* Pour voir seulement des fictions de 2010 : 👉 `/books?genre=fiction&year=2010`

🔍 Décryptage :

* `?genre=fiction` → On veut des livres **de fiction**.
* `&year=2010` → On veut ceux sortis en **2010**.

📌 **Pourquoi c’est utile ?**

* Sans paramètres, l’API montre **tous les livres** (trop large).
* Avec eux, on peut **demander juste ce qu’on veut**.


---
## **🎯 Exemples dans des applis qu’on connaît**

🔹 **Films 🎬** :
👉 `/movies?genre=action&year=2023` → films d’action de 2023.

🔹 **Météo ☀️** :
👉 `/weather?city=Paris&date=2024-03-10` → météo de Paris à une date précise.

🔹 **Shopping 🛒** :
👉 `/products?category=shoes&color=red` → chaussures rouges seulement.

---

## **📌 Comment en mettre plusieurs ?**

Pour **ajouter plusieurs critères**, on les sépare avec `&`.

Exemple avec des hôtels 🏨 :
👉 `/hotels?city=NewYork&price_max=200&rating=4`

* `city=NewYork` → à **New York**
* `price_max=200` → **maximum 200€**
* `rating=4` → **au moins 4 étoiles**

🎯 Résultat : on voit **seulement les hôtels qui nous vont**.

---
## **🧐 Pourquoi c’est super utile ?**

💡 Les **paramètres de requête** aident l’API à **répondre exactement** à ce qu’on cherche.

Ça rend l’appli **plus claire et agréable à utiliser**.

🚀 **Et s’il n’y avait pas de paramètres ?**

* Tu devrais faire défiler **tous les films** sur Netflix.
* Voir **tous les produits** sur Amazon.
* Lire **toute la météo** au lieu de "Paris demain".

🎯 C’est pour ça que les **API modernes utilisent toujours cette méthode** : pour montrer **juste ce qu’il faut**.

---

### **📌 En résumé !**

✅ Les **paramètres de requête** servent à **filtrer les réponses**.
✅ Ils viennent **après un `?`**, sous forme de **clé=valeur**.
✅ On peut en mettre **plusieurs avec `&`**.
✅ On les trouve **dans presque toutes les applis**.

---

🎯 Ils rendent les applis **plus malignes et rapides** ! 🚀



#7

### **Ajout de paramètres de requête dans notre bibliothèque 📚**

On a vu comment un **endpoint** (une porte 📡) sert à récupérer des infos.
Maintenant, on va lui ajouter des **paramètres de requête** pour **filtrer ce qu’on cherche**.

L’idée est simple : au lieu de voir **tous les livres**, on veut que l’utilisateur puisse **filtrer** par **année**.
Par exemple : voir **seulement ceux de 2020**.

Voici le code qui permet d’ajouter cette fonctionnalité :  

```python
@app.get("/books")
async def read_books(year: int = None):
    if year:
        return {
            "year": year,
            "books": ["Book 1", "Book 2"]
        }
    return {"books": ["All Books"]}
```

Voyons **chaque partie** de ce code et ce qu’elle fait ! 🚀  

---

## **1️⃣ @app.get("/books")**

🔹 `@app.get("/books")`

* On crée un **endpoint GET** (une porte pour récupérer des infos).
* `"books"` veut dire : **liste des livres**.

🎯 **Comme une bibliothèque virtuelle** :

Tu dis juste → *"Montre-moi les livres disponibles !"* 📚

📌 **Autres exemples d’applis :**

* **Films 🎬** : `/movies` → liste des films.
* **Shopping 🛒** : `/products` → tous les produits.

---

## **2️⃣ async def read\_books(year: int = None):**

🔹 `def` = **je crée une fonction** (petit programme).
🔹 `async` = elle répond **vite** et à **plusieurs personnes à la fois** 📞.
🔹 `read_books` = **le nom** de la fonction.

🔹 `(year: int = None)`

* `year` est un **paramètre de requête** (une info qu’on peut envoyer).
* `int` = il doit être **un nombre entier**.
* `= None` = **c’est optionnel** → s’il n’est pas donné, l’API montre **tous les livres**.

🎯 **Comme à la bibliothèque** :

* *"Montre-moi tous les livres"* → si on ne précise rien.
* *"Montre-moi les livres de 2020"* → si on donne une année.

📌 **Exemples dans d’autres applis :**

* **Météo ☀️** : `/weather?city=Paris` → météo à Paris.
* **Musique 🎵** : `/songs?genre=pop` → chansons pop.

---

## **3️⃣ Vérifier si une année est demandée (`if year:`)**

🔹 `if year:`

* Ça veut dire : **"Est-ce que l’utilisateur a donné une année ?"**
* Si **oui**, l’API montre **seulement les livres de cette année-là**.


🎯 **Comme un bibliothécaire qui te dit** :

📚 *"Tu veux tous les livres ou juste ceux d’une année ?"* 

---

## **4️⃣ Retourner les résultats en fonction de la demande**  

```python
return {
    "year": year,
    "books": ["Book 1", "Book 2"]
}
```

🔹 `return { ... }`

* Ça veut dire : **"voici la réponse de l’API"**.
* La réponse est un **dictionnaire** (une boîte 📦 avec plusieurs infos dedans).

🔹 `"year": year`

  * Montre **l’année demandée** pour confirmer le filtre.

🔹 `"books": ["Book 1", "Book 2"]`

  * Donne la **liste des livres** trouvés pour cette année.
 

🎯 **Comme avec un bibliothécaire 📚** :
*"Tu veux les livres de 2020 ?"*
*"OK, voilà deux livres sortis en 2020."*

---

## **5️⃣ Si aucun filtre n’est donné**

```python
return {"books": ["All Books"]}  
```

* Si on **ne précise pas d’année**, l’API montre **tous les livres**.

🎯 **Comme au cinéma 🎥** :
Tu dis juste : *"Montre-moi tous les films !"*
Et on te montre **tout ce qu’il y a**.

📌 **Exemples dans d’autres applis :**

* **Films 🎬** : sans filtre → on voit **tous les films**.
* **Shopping 🛒** : sans catégorie → on voit **tous les produits**.

---

### **📌 Résumé final !**

✅ Les **paramètres de requête** servent à **filtrer les résultats**.
✅ Avec **FastAPI**, on peut ajouter un **paramètre optionnel** (`year: int = None`).
✅ Si on donne une **année**, l’API montre **les livres de cette année**.
✅ Si on ne met rien, elle montre **tous les livres**.

📌 **Les API font ça partout** :

* 🎵 Chercher des chansons par genre.
* 🏨 Filtrer des hôtels par prix.

---

🚀 **Avec les paramètres de requête, l’API devient plus maligne et sur-mesure !**


#8

### **Un paramètre optionnel : comment ça marche ? 🎯**

Dans notre **bibliothèque virtuelle 📚**, on a ajouté un paramètre **year**.

Il sert à demander **juste les livres d’une année précise**.

Mais attention ! Ce paramètre est **optionnel** (pas obligé).

Si on ne le met pas, l’API montre **tous les livres** sans filtre.

---

### **📌 C’est quoi un paramètre optionnel ?**

C’est une info qu’on **peut donner à l’API**, mais ce **n’est pas obligatoire**. 

Dans notre cas, `year` vaut **None** (ça veut dire "rien").

Donc si l’utilisateur **ne donne pas d’année**, l’API montre **tous les livres**.
 
🎯 **Comme à la bibliothèque** :
📚 *"Montre-moi tous les livres !"* → Il te montre **tout**.
📚 *"Montre-moi ceux de 2020 !"* → Il te montre **juste les livres de 2020**.

Le fait de pouvoir poser la **question sans donner d’année** montre que l’année est un **paramètre optionnel**.

---

### **📌 Comment ça marche dans notre API ?**

Si l’utilisateur donne une **année**, l’API **filtre** les livres.

👉 `/books?year=2020` ➡️ montre **seulement les livres de 2020**.

Si l’utilisateur **ne met rien**, l’API montre **tous les livres**.
👉 `/books` ➡️ **Liste complète des livres**.

---

### **📌 Où voit-on ça ailleurs ?**

Les **paramètres optionnels** sont **partout** !

🔹 **Météo ☀️**

* `/weather?city=Paris` → météo de Paris
* `/weather` → météo du jour

🔹 **Films 🎬**

* `/movies?year=2023` → films de 2023
* `/movies` → tous les films

🔹 **Shopping 🛒**

* `/products?category=shoes` → que les chaussures
* `/products` → tous les articles


---

### **📌 Pourquoi c’est utile ?**

💡 Les **paramètres optionnels** aident à **personnaliser la recherche** sans devoir tout remplir.

🚀 **Sans ces paramètres :**

* Tu verrais **tous les articles** sur Amazon, sans pouvoir dire "chaussures rouges".
* Netflix te montrerait **tous les films**, même si tu veux juste les nouveaux.
* Google Maps afficherait **toutes les villes** du monde.

🎯 Les **paramètres optionnels** rendent l’API **plus pratique et facile à utiliser** !


---

### **📌 Récapitulons !**

✅ Un **paramètre optionnel** = info qu’on **peut donner**, mais **pas obligé**.
✅ Dans notre API, `year` est **optionnel** :
→ Si on le donne, l’API **filtre**.
→ Si on ne le donne pas, elle **montre tout**.
✅ Ce système est utilisé **dans plein d’applis** pour filtrer sans tout remplir.

---

🚀 Grâce à ça, l’API est **plus intelligente et plus pratique** !


#9

# La suite du texte précédent
Exercise

Using the APIRouter class, refactor each endpoint in a separate file and add the route to the FastAPI server.